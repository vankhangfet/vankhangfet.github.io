---
layout: post
title: Durable Execution với Temporal.
tags: [Design]
---
Trong thực tế chúng ta sẽ gặp những tình huống mà hệ thống cần phải thực hiện các tác vụ một cách tuần tự, và tác vụ cần phải được đảm bảo thực thi một 
cách an toàn, đáng tin cậy. Để đảm bảo trạng thái được xử lý an toàn đáng tin cậy trong hệ thống phân tán đòi hỏi thiết kế tốt, cũng như công sức xây dựng hệ thống
là tốn kém. Khi làm việc với hệ thống phân tán, các developer sẽ phải giải quyết những vấn đề sau:
(Reliable execution, Code structure, State visibility) 
- Ứng dụng phân tán đáng tin cậy
- Mô hình phát triển năng suất và cấu trúc mã nguồn cho các ứng dụng phân tán.
- Trạng thái của ứng dụng, tác vụ có thể được kiểm soát, thể hiện một cách dễ dàng.

<img src="https://images.ctfassets.net/0uuz8ydxyd9p/6SI3KL8ctPLvTvHzFjKUDX/5ac9e8303f076637a663afe690381ac6/workflow-details-page-how-it-works.png?w=1600&fm=avif&q=60" width="400px">

Để hiểu rõ hơn về Temporal, chúng ta hãy xem các vấn đề với các kiến trúc, pattern quen thuộc sau trong hệ thống phân tán nều như không sử dụng,
và sử dụng Temporal.

### *Don't fight dev patterns, ship code.*

Event-Driven Architectures

Trong kiến trúc hướng sự kiện, chúng ta sẽ thường thấy có các message queu nhằm giúp cho các component có thể giao tiếp với nhau, 
cũng như tăng khả năng scale của hệ thống.

Tuy nhiên để quản lý trạng thái các service cũng như chia sẻ trạng thái giữa các service là phức tạp. Để giảm thiểu sự phức tạp này 
Temporal sẽ giúp chúng ta làm được điều này.

<img src="https://images.ctfassets.net/0uuz8ydxyd9p/4pPIlt0w80BbF6mqGrEjO/6ef14535ea80f8b686d1fe731c2d49a6/EDA_Diagram_3x.png?h=800&fm=avif&q=60" width="400px">

State Machines

Đây là một pattern rất mạnh mẽ, nó giúp các deverlop xây dựng logic của ứng dụng một cách trong sáng. Tuy nhiên khi hệ thống có thêm state mới, cũng như logic ngày càng phức tạp thì việc kiểm thử và bảo trì sẽ có thể là một vấn đề khó khăn trong tương lai.

Khi làm việc với Temporal thi trạng thái của flow cũng như function sẽ được Temporal tự động ghi lại, truy dấu. Do đó bạn có thể đơn giản hóa flow cũng như state machine.

<img src="https://images.ctfassets.net/0uuz8ydxyd9p/64YIKRN1Dype1XpU6OyeU0/6c6e2d21b3d7d87fb0de5aae8216d45d/State_Machine_Diagram_3x.png?h=800&fm=avif&q=60" width="400px">

Scheduled Jobs & Cron

Cron là một quy trình phần lớn thủ công, có thể không đáng tin cậy và không cung cấp khả năng kiểm soát quá trình thực thi.
Với Temporal bạn có thể thay thế Cron bằng Workflow theo lịch trình để được thực thi một cách đáng tin cậy. Bạn có thể start or stop, thậm chí thiết lập các trigger để thực thi.

<img src="https://images.ctfassets.net/0uuz8ydxyd9p/6m8IbVkFH3P4apCpY1aWkL/d4f49a164ed9a15a30bc68d2b2f92bc1/Schedules_Diagram_3x.png?h=800&fm=avif&q=60" width="400px">

.....

